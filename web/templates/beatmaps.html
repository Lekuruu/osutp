{{ define "beatmaps" }}
{{ template "header" . }}
<h1>Beatmap difficulty</h1>
<p>
    The level of a beatmap is determined by it's so called speed and aim difficulty.
    Speed difficulty is greatly determined by how fast the map is while aim difficulty depends on how hard it is to aim
    correctly.
</p>
<form class="form" action="/beatmaps" method="get">
    <table class="search-form-limits">
        <tbody>
            <tr>
                <th>Mods</th>
                <th>Approach rate</th>
                <th>Circle size</th>
                <th>Overall difficulty</th>
                <th>Speed to aim ratio</th>
            </tr>
            <tr>
                <td>
                    <table class="search-form-mods">
                        <tbody>
                            <tr>
                                <td>
                                    {{ $doubleTime := query "DT" "0" .Query }}
                                    <input type="checkbox" name="DT" value="1" onclick="this.form.HT.checked=false" {{ if eq $doubleTime "1" }}checked{{ end }}>
                                    <span class="mod-dt">DoubleTime</span>
                                </td>
                                <td>
                                    {{ $hardRock := query "HR" "0" .Query }}
                                    <input type="checkbox" name="HR" value="1" onclick="this.form.EZ.checked=false" {{ if eq $hardRock "1" }}checked{{ end }}>
                                    <span class="mod-hr">HardRock</span>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    {{ $halfTime := query "HT" "0" .Query }}
                                    <input type="checkbox" name="HT" value="1" onclick="this.form.DT.checked=false" {{ if eq $halfTime "1" }}checked{{ end }}>
                                    <span class="mod-ht">HalfTime</span>
                                </td>
                                <td>
                                    {{ $easy := query "EZ" "0" .Query }}
                                    <input type="checkbox" name="EZ" value="1" onclick="this.form.HR.checked=false" {{ if eq $easy "1" }}checked{{ end }}>
                                    <span class="mod-easy">Easy</span>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                </td>
                <td>
                    <input type="text" name="arl" size="4" maxlength="5" value="{{ query "arl" "0" .Query }}"> -
                    <input type="text" name="arh" size="4" maxlength="5" value="{{ query "arh" "11" .Query }}">
                </td>
                <td>
                    <input type="text" name="csl" size="4" maxlength="5" value="{{ query "csl" "0" .Query }}"> -
                    <input type="text" name="csh" size="4" maxlength="5" value="{{ query "csh" "10" .Query }}">
                </td>
                <td>
                    <input type="text" name="odl" size="4" maxlength="5" value="{{ query "odl" "0" .Query }}"> -
                    <input type="text" name="odh" size="4" maxlength="5" value="{{ query "odh" "11" .Query }}">
                </td>
                <td>
                    <input type="text" name="s" size="2" maxlength="3" value="{{ .SpeedRatio }}" onkeyup="if(this.value &gt; 100) this.value=100; if(this.value &lt; 0) this.value=0; this.form.elements[11].value=100-this.value">

                    :

                    <input type="text" size="2" maxlength="3" value="{{ .AimRatio }}" onkeyup="if(this.value &gt; 100) this.value=100; if(this.value &lt; 0) this.value=0; this.form.s.value=100-this.value">
                </td>
            </tr>
        </tbody>
    </table>
    <div class="search-form-search">
        {{ $nameFilter := query "n" "" .Query }}
        <input type="text" name="n" size="30" maxlength="30" placeholder="Beatmap name" value="{{ $nameFilter }}">
        <input type="submit" value="Search">
        <input type="reset" value="Reset">
        <input type="reset" value="Default" onclick="document.location='/beatmaps'">
        <select name="u" size="1">
            {{ $rankedFilter := query "u" "1" .Query }}
            <option value="0" {{ if eq $rankedFilter "0" }}selected{{ end }}>All</option>
            <option value="1" {{ if eq $rankedFilter "1" }}selected{{ end }}>Ranked</option>
            <option value="2" {{ if eq $rankedFilter "2" }}selected{{ end }}>Unranked</option>
        </select>
    </div>
    {{ template "pagination" .Pagination }}
    <table class="beatmaps">
        <tbody>
            <tr>
                <th>Rank</th>
                <th>Beatmap name</th>
                <th style="padding-left:0px">Stars (speed | aim)</th>
                <th onmouseover="Tip('Approach rate')" onmouseout="UnTip()">AR</th>
                <th onmouseover="Tip('Circle size')" onmouseout="UnTip()">CS</th>
                <th onmouseover="Tip('Overall difficulty')" onmouseout="UnTip()">OD</th>
                <th></th>
            </tr>
            {{ $index := 0 }}
            {{ range $map := .Beatmaps }}
            <tr class="row2">
                {{ $starRating := $map.StarRating $.Mods }}
                {{ $aimStars := $map.AimStars $.Mods }}
                {{ $speedStars := $map.SpeedStars $.Mods }}
                {{ $approachRate := $map.ApproachRate $.Mods }}
                {{ $circleSize := $map.CircleSize $.Mods }}
                {{ $overallDifficulty := $map.OverallDifficulty $.Mods }}
                <td><span style="font-weight:bold">#{{ add $index $.Pagination.Start }}</span></td>
                {{ $index = add $index 1 }}
                <td onmouseover="Tip('Creator: {{ $map.Creator }}&lt;br/&gt;Source: {{ $map.Source }}')" onmouseout="UnTip()">
                    <a href="http://osu.ppy.sh/b/{{ $map.ID }}">
                        <span style="color:#6666aa">{{ $map.Artist }}</span> - <span style="color:#000000">{{ $map.Title }}</span> 
                        <span style="color:#222244">[{{ $map.Version }}]</span>
                    </a>
                </td>
                <td style="padding-left:10px">
                    <span style="font-weight:bold">{{ printf "%.2f" $starRating }}</span>
                    ({{ printf "%.2f" $speedStars }} | {{ printf "%.2f" $aimStars }})
                </td>
                <td style="text-align:center">{{ printf "%.1f" $approachRate }}</td>
                <td style="text-align:center">{{ printf "%.1f" $circleSize }}</td>
                <td style="text-align:center">{{ printf "%.1f" $overallDifficulty }}</td>
                <td style="text-align:center" onmouseover="Tip('Last update: {{ $map.LastScoreUpdate.Format "2006-02-01" }}')" onmouseout="UnTip()">
                    <a href="/scores?bid={{ $map.ID }}">scores</a>
                </td>
            {{ end }}
        </tbody>
    </table>
    {{ template "pagination" .Pagination }}
</form>
{{ template "footer" . }}
{{ end }}